"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("reselect"),r=require("rxjs"),n=require("rxjs/operators"),o=require("ts-action");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function a(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e}(e=exports.FlattenOperator||(exports.FlattenOperator={})).switchMap="switchMap",e.mergeMap="mergeMap",e.concatMap="concatMap",e.exhaustMap="exhaustMap";var u=function(e){return null!==e&&"object"==typeof e},c=r.pipe(n.catchError((function(e){return r.of(e)}))),p=function(e){return e.pipe(c)},f=function(e){return r.isObservable(e)?e:e instanceof Promise?r.from(e):r.of(e)};function s(e){var t=i(e,3),r=t[0],o=t[1],u=t[2];return n.scan((function(e,t){return u.length>0?u.reduce((function(e,t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return e(t.apply(void 0,a(r)))}}))(o)(e,t):o(e,t)}),r)}var l={switchMap:n.switchMap,mergeMap:n.mergeMap,concatMap:n.concatMap,exhaustMap:n.exhaustMap};
/**
 * Reactive state container based on RxJS (https://rxjs.dev/)
 *
 * @class AsyncStore<State, ActionsUnion>
 *
 * @type State - application state interface
 * @type ActionsUnion - type union of all the actions
 */
var d=
/**
     * Default configuration
     *
     * @param {Object} config
     *  {
     *     reducer$: of(reducer({})),
     *     actionStream$: EMPTY, // if not defined, no actions will be dispatched in the store
     *     initialState$: of({}),
     *     middleware$: of([]),
     *     destroy$: NEVER // if not defined, the state subscription will live forever
     *  }
     *
     * @param {Object} options
     *  {
     *     actionFop: FlattenOps.concatMap, // Flatten operator for actions's stream.
     *     stateFop: FlattenOps.switchMap // Flatten operator for state's stream.
     *     windowTime: undefined //Maximum time length of the replay buffer in milliseconds.
     *     bufferSize: 1 //Maximum element count of the replay buffer.
     *  }
     */
function(e,t){this.config=e,this.options=t;var i=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e&&e.reducer$&&e.reducer$.pipe(c)||r.of(o.reducer({})),a=new r.Subject,s=(e&&e.initialState$&&e.initialState$.pipe(c)||r.of({})).pipe(n.share()),d=e&&e.middleware$&&e.middleware$.pipe(c)||r.of([]),m=e&&e.destroy$&&e.destroy$.pipe(c)||r.NEVER,h=l[t&&t.actionFlatOp||exports.FlattenOperator.concatMap],S=l[t&&t.stateFlatOp||exports.FlattenOperator.switchMap],x=t&&t.bufferSize||1,$=t&&t.windowTime;return{reducer$:i,actions$:a,actionStream$:function(t){return(e&&e.actionStream$&&e.actionStream$.pipe(c)||r.EMPTY).pipe(n.filter(u),n.map(f),h(p),n.tap(a),t,n.map(f))},initialState$:s,middleware$:d,destroy$:m,flattenState$:function(e){return e.pipe(S(p),n.map(f),S(p))},shareReplayConfig:{refCount:!1,bufferSize:x,windowTime:$}}}(this.config,this.options),a=i.reducer$,d=i.actions$,m=i.actionStream$,h=i.middleware$,S=i.initialState$,x=i.destroy$,$=i.flattenState$,b=i.shareReplayConfig;this.state$=r.combineLatest(S,a,h).pipe(n.map(s),n.concatMap(m),n.startWith(S),$,n.takeUntil(x),n.shareReplay(b)),this.state$.subscribe(),this.actions$=d.pipe(n.shareReplay(b))};Object.keys(o).forEach((function(e){"default"!==e&&Object.defineProperty(exports,e,{enumerable:!0,get:function(){return o[e]}})})),Object.defineProperty(exports,"createSelector",{enumerable:!0,get:function(){return t.createSelector}}),Object.defineProperty(exports,"createSelectorCreator",{enumerable:!0,get:function(){return t.createSelectorCreator}}),Object.defineProperty(exports,"createStructuredSelector",{enumerable:!0,get:function(){return t.createStructuredSelector}}),Object.defineProperty(exports,"defaultMemoize",{enumerable:!0,get:function(){return t.defaultMemoize}}),exports.Store=d,exports.catchErr=c,exports.createStore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),new d(e,t)}
/**
 *
 * @param mapFn - a function to map a state with
 * @returns {MiddlewareFn} MiddlewareFn<State>
 *
 * PS - previous state
 * NS - next state
 */,exports.filterA=function(e){return function(t){return function(r,n){return e(n)?t(r,n):r}}},exports.filterNS=function(e){return function(t){return function(r,n){var o=t(r,n);return e(o)?o:r}}},exports.filterPS=function(e){return function(t){return function(r,n){return e(r)?t(r,n):r}}},exports.mapA=function(e){return function(t){return function(r,n){return t(r,e(n))}}},exports.mapNS=function(e){return function(t){return function(r,n){return e(t(r,n))}}},exports.mapPS=function(e){return function(t){return function(r,n){return t(e(r),n)}}},exports.mapToObservable=f,exports.reduceA=function(e){return function(t){return function(r,n){return t(r,e(r,n))}}},exports.reduceNS=function(e){return function(t){return function(r,n){return e(t(r,n),n)}}},exports.reducePS=function(e){return function(t){return function(r,n){return t(e(r,n),n)}}};
